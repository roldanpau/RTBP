<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>splitting_prog: /home/pau/research/splitting_prog/prtbp/prtbp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">splitting_prog</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>/home/pau/research/splitting_prog/prtbp/prtbp.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>Poincare map of the Restricted Three Body Problem.  
<a href="#_details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_errno.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_roots.h&gt;</code><br/>
<code>#include &lt;frtbp.h&gt;</code><br/>
<code>#include &lt;rtbp.h&gt;</code><br/>
<code>#include &quot;prtbp.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for prtbp.c:</div>
<div class="dyncontent">
<div class="center"><img src="prtbp_8c__incl.png" border="0" usemap="#_2home_2pau_2research_2splitting__prog_2prtbp_2prtbp_8c" alt=""/></div>
<map name="_2home_2pau_2research_2splitting__prog_2prtbp_2prtbp_8c" id="_2home_2pau_2research_2splitting__prog_2prtbp_2prtbp_8c">
</map>
</div>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinter__f__params.html">inter_f_params</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5282b311cc603fb3ca5c6c0624f3a353"></a><!-- doxytag: member="prtbp.c::inter" ref="a5282b311cc603fb3ca5c6c0624f3a353" args="(double mu, section_t sec, double epsabs, double x[DIM], double t0, double t1, double *t)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>inter</b> (double <a class="el" href="frtbp_8c.html#a74577585cf12d1712ab9c57616d49205">mu</a>, section_t sec, double epsabs, double x[DIM], double t0, double t1, double *t)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a666733b5ffda7d728d3524e395f980b5"></a><!-- doxytag: member="prtbp.c::inter_f" ref="a666733b5ffda7d728d3524e395f980b5" args="(double t, void *p)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>inter_f</b> (double t, void *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#a6cced3544f6ddfed54297f12824ef0cf">onsection</a> (section_t sec, double a[DIM], int *sign)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#ab754a9e94e62d1400859c5aa952e8d65">crossing</a> (section_t sec, double a[DIM], double b[DIM], int *sign)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#ae2068a782d6e50d63718fec38d77e31f">prtbp</a> (double <a class="el" href="frtbp_8c.html#a74577585cf12d1712ab9c57616d49205">mu</a>, section_t sec, int cuts, double x[DIM], double *ti)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#a518d5cd6341e8ea73f37ed1a9338fb8c">prtbp_inv</a> (double <a class="el" href="frtbp_8c.html#a74577585cf12d1712ab9c57616d49205">mu</a>, section_t sec, int cuts, double x[DIM], double *ti)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac450b8001e59c6e9d91c135a2154944a"></a><!-- doxytag: member="prtbp.c::POINCARE_TOL" ref="ac450b8001e59c6e9d91c135a2154944a" args="" -->
const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#ac450b8001e59c6e9d91c135a2154944a">POINCARE_TOL</a> = 1.e-16</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">error bound (tolerance) for Poincare map <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8238331f6ef31220593dd74611d28972"></a><!-- doxytag: member="prtbp.c::SHORT_TIME" ref="a8238331f6ef31220593dd74611d28972" args="" -->
const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prtbp_8c.html#a8238331f6ef31220593dd74611d28972">SHORT_TIME</a> = 0.01</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">integration "step" for prtbp <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adc64fc3ca33ccf1fb82dc8967763f4e5"></a><!-- doxytag: member="prtbp.c::ERR_MAXITER" ref="adc64fc3ca33ccf1fb82dc8967763f4e5" args="" -->
const int&#160;</td><td class="memItemRight" valign="bottom"><b>ERR_MAXITER</b> = 1</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Poincare map of the Restricted Three Body Problem. </p>
<dl class="rcs"><dt><b>Author:</b></dt><dd>roldan </dd></dl>
<dl class="rcs"><dt><b>Date:</b></dt><dd>2013-03-26 22:22:14 </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab754a9e94e62d1400859c5aa952e8d65"></a><!-- doxytag: member="prtbp.c::crossing" ref="ab754a9e94e62d1400859c5aa952e8d65" args="(section_t sec, double a[DIM], double b[DIM], int *sign)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crossing </td>
          <td>(</td>
          <td class="paramtype">section_t&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>[DIM], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>[DIM], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sign</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Let $a$ and $b$ be two consecutive points in an orbit. This function determines if the trajectory from $a$ to $b$ does cross the poincare section sec or not.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>type of Poincare section (sec = SEC1 or SEC2). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>First point, 4 coordinates: (x, y, p_x, p_y). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Second point, 4 coordinates: (x, y, p_x, p_y).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sign</td><td>(pointer to) sign of previous intersection with x axis (sign = +1 if x&gt;0 or sign = -1 if x&lt;0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if trajectory cuts section, false if it does not. </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65_icgraph.png" border="0" usemap="#prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65_icgraph" alt=""/></div>
<map name="prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65_icgraph" id="prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6cced3544f6ddfed54297f12824ef0cf"></a><!-- doxytag: member="prtbp.c::onsection" ref="a6cced3544f6ddfed54297f12824ef0cf" args="(section_t sec, double a[DIM], int *sign)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool onsection </td>
          <td>(</td>
          <td class="paramtype">section_t&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>[DIM], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>sign</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function determines if the point A is exactly on the section.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>type of Poincare section (sect = SEC1 or SEC2). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>point, 4 coordinates: (x, y, p_x, p_y).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sign</td><td>(pointer to) sign of previous intersection with x axis (sign = +1 if x&gt;0 or sign = -1 if x&lt;0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if point $a$ is exactly on section, false if it is not. </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf_icgraph.png" border="0" usemap="#prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf_icgraph" alt=""/></div>
<map name="prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf_icgraph" id="prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae2068a782d6e50d63718fec38d77e31f"></a><!-- doxytag: member="prtbp.c::prtbp" ref="ae2068a782d6e50d63718fec38d77e31f" args="(double mu, section_t sec, int cuts, double x[DIM], double *ti)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prtbp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">section_t&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cuts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>[DIM], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Poincare map of the Restricted Three Body Problem.</p>
<p>Consider the RTBP in rotating coordinates. Let S be the Poincare section SEC1 or SEC2, corresponding to {y=0, v_y&gt;0} or {y=0, v_y&lt;0}. Let $x$ be a point in the section, and suppose that flow at $x$ is transversal to the section. Compute the n-th iterate of the Poincare map $P^n(x)$ of the RTBP. This procedure also computes, as a side product, the integration time to intersect the Poincare section "n" times.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>mass parameter for the RTBP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>type of Poincare section (sec = SEC1 or SEC2).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cuts</td><td>number of iterates of the Poincare map (cuts=n: n cuts with the Poincare section).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>Initial point, 4 coordinates: (X, Y, P_X, P_Y). On return of the this function, it holds the image point $P^n(x)$.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ti</td><td>On return, it holds the integration time to intersect the Poincare section "n" times.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns a non-zero error code to indicate an error and 0 to indicate success. If an integration error is encountered, the function returns a non-zero value.</dd></dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>We are only interested in orbits that go around the origin. For some values of the energy, the orbit has "contractible" loops, which we want to avoid. For this, we impose that TWO CONSECUTIVE ITERATES do NOT lie both to the right or to the left of the origin.</dd>
<dd>
On successful return of this function, the point $x$ is exactly on the section, i.e. we set coordinate $y$ exactly equal to zero. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prtbp_8c_ae2068a782d6e50d63718fec38d77e31f_cgraph.png" border="0" usemap="#prtbp_8c_ae2068a782d6e50d63718fec38d77e31f_cgraph" alt=""/></div>
<map name="prtbp_8c_ae2068a782d6e50d63718fec38d77e31f_cgraph" id="prtbp_8c_ae2068a782d6e50d63718fec38d77e31f_cgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a518d5cd6341e8ea73f37ed1a9338fb8c"></a><!-- doxytag: member="prtbp.c::prtbp_inv" ref="a518d5cd6341e8ea73f37ed1a9338fb8c" args="(double mu, section_t sec, int cuts, double x[DIM], double *ti)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prtbp_inv </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">section_t&#160;</td>
          <td class="paramname"><em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cuts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>[DIM], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Inverse Poincare map of the Restricted Three Body Problem.</p>
<p>Consider the RTBP in rotating coordinates. Let S be the Poincare section SEC1 or SEC2, corresponding to {y=0, v_y&gt;0} or {y=0, v_y&lt;0}. Let $x$ be a point in the section, and suppose that flow at $x$ is transversal to the section. Compute the n-th iterate of the inverse Poincare map $P^{-n}(x)$ of the RTBP. This procedure also computes, as a side product, the integration time to intersect the Poincare section "n" times.</p>
<p>NOTE: We are only interested in orbits that go around the origin. For some values of the energy, the orbit has "contractible" loops, which we want to avoid. For this, we impose that TWO CONSECUTIVE ITERATES do NOT lie both to the right or to the left of the origin.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>mass parameter for the RTBP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>type of Poincare section (sec = SEC1 or SEC2).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cuts</td><td>number of iterates of the Poincare map (cuts=n: n cuts with the Poincare section).</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>Initial point, 4 coordinates: (X, Y, P_X, P_Y). On return of the this function, it holds the image point $P^{-n}(x)$.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ti</td><td>On return, it holds the integration time to intersect the Poincare section "n" times. Since we are computing the inverse Poincare map, this integration time "ti" must be negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Returns a non-zero error code to indicate an error and 0 to indicate success. If an integration error is encountered, the function returns a non-zero value. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c_cgraph.png" border="0" usemap="#prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c_cgraph" alt=""/></div>
<map name="prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c_cgraph" id="prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c_cgraph">
</map>
</div>
</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 22 2015 10:50:56 for splitting_prog by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
