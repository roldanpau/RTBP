\hypertarget{errmfld_8c}{
\section{/home/pau/research/splitting\_\-prog/errmfld/errmfld.c File Reference}
\label{errmfld_8c}\index{/home/pau/research/splitting\_\-prog/errmfld/errmfld.c@{/home/pau/research/splitting\_\-prog/errmfld/errmfld.c}}
}


Estimate error commited in the linear approximation of the manifold.  


{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$prtbp.h$>$}\par
{\ttfamily \#include $<$prtbp\_\-2d.h$>$}\par
Include dependency graph for errmfld.c:
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{errmfld_8c_a6d46908b6f0d48d665c9bb6fabdaac6c}{err\_\-mfld} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, double H, int k, double p\mbox{[}2\mbox{]}, double v\mbox{[}2\mbox{]}, double lambda, int stable, double h)
\item 
double \hyperlink{errmfld_8c_ab913a873449a95304903ca2b824fd1d7}{h\_\-opt} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, double H, int k, double p\mbox{[}2\mbox{]}, double v\mbox{[}2\mbox{]}, double lambda, int stable)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Estimate error commited in the linear approximation of the manifold. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/03-\/11 11:19:12 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{errmfld_8c_a6d46908b6f0d48d665c9bb6fabdaac6c}{
\index{errmfld.c@{errmfld.c}!err\_\-mfld@{err\_\-mfld}}
\index{err\_\-mfld@{err\_\-mfld}!errmfld.c@{errmfld.c}}
\subsubsection[{err\_\-mfld}]{\setlength{\rightskip}{0pt plus 5cm}int err\_\-mfld (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double}]{p\mbox{[}2\mbox{]}, }
\item[{double}]{v\mbox{[}2\mbox{]}, }
\item[{double}]{lambda, }
\item[{int}]{stable, }
\item[{double}]{h}
\end{DoxyParamCaption}
)}}
\label{errmfld_8c_a6d46908b6f0d48d665c9bb6fabdaac6c}
Estimate error commited in the linear approximation of the manifold.

Let \$p\$ be a hyperbolic fixed point for the 2D map \$\{P\}\$. Assume that $\lambda$ is the unstable eigenvalue, with $\lambda>1$ (case stable flag=0), or $\lambda$ is the stable eigenvalue, with $\lambda<1$ (case stable flag=1). Let \$v\$ be the unstable (resp. stable) eigenvector for the eigenvalue $\lambda$. Given a displacement \$h\$ from the fixed point along the linear eigenspace, we consider the point \$p+hv\$. The error commited in the local approximation of the manifold is given by \[ err(h) = ||\mathcal{P}(p+hv)-p-\lambda hv|| \in O(h^2). \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter for the RTBP \\
\hline
\mbox{\tt in}  & {\em sec} & type of Poincare section (sec = SEC1 or SEC2). \\
\hline
\mbox{\tt in}  & {\em H} & energy value \\
\hline
\mbox{\tt in}  & {\em k} & number of iterates of the Poincare map \\
\hline
\mbox{\tt in}  & {\em p} & fixed point \$p=(x,p\_\-x)\$ \\
\hline
\mbox{\tt in}  & {\em v} & eigenvector associated to unstable (or stable) direction \\
\hline
\mbox{\tt in}  & {\em lambda} & eigenvalue associated to unstable (or stable) direction\\
\hline
\mbox{\tt in}  & {\em stable} & flag indicating unstable manifold (stable=0) or stable manifold (stable=1).\\
\hline
\mbox{\tt in}  & {\em h} & linear displacement along the manifold.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the error commited in the linear approximation of the manifold. 
\end{DoxyReturn}


Here is the caller graph for this function:


\hypertarget{errmfld_8c_ab913a873449a95304903ca2b824fd1d7}{
\index{errmfld.c@{errmfld.c}!h\_\-opt@{h\_\-opt}}
\index{h\_\-opt@{h\_\-opt}!errmfld.c@{errmfld.c}}
\subsubsection[{h\_\-opt}]{\setlength{\rightskip}{0pt plus 5cm}double h\_\-opt (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double}]{p\mbox{[}2\mbox{]}, }
\item[{double}]{v\mbox{[}2\mbox{]}, }
\item[{double}]{lambda, }
\item[{int}]{stable}
\end{DoxyParamCaption}
)}}
\label{errmfld_8c_ab913a873449a95304903ca2b824fd1d7}
Compute optimal displacement \$h\$ from the fixed point along the linear eigenspace.

Let \$p\$ be a hyperbolic fixed point for the 2D map \$\{P\}\$. Assume that $\lambda$ is the unstable eigenvalue, with $\lambda>1$ (case stable flag=0), or $\lambda$ is the stable eigenvalue, with $\lambda<1$ (case stable flag=1). Let \$v\$ be the unstable (resp. stable) eigenvector for the eigenvalue $\lambda$. Let \$h\$ be a displacemnt from the fixed point along the linear eigenspace. If \$h\$ is chosen too large, then the local error approximating the manifold is too large. On the other hand, if \$h\$ is chosen too small, then we need to iterate the map \$\{P\}\$ in order to globalize the manifold, and this leads to accumulation of numerical errors.

This function computes an ``optimal'' value of \$h\$, according to the following algorithm: \$h\$ is iteratively decreased by a factor 0.1 until the local error is not reduced much. We also harcode a minimum threshold for the local error, \$err(h)$>$10$^\wedge$\{-\/8\}\$, because we don't want to decrease \$h\$ too much.

NOTE: Probably a better way to choose \$h\$ is to minimize the empirical numerical error commited in computing the homoclinic point.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter for the RTBP \\
\hline
\mbox{\tt in}  & {\em sec} & type of Poincare section (sec = SEC1 or SEC2). \\
\hline
\mbox{\tt in}  & {\em H} & energy value \\
\hline
\mbox{\tt in}  & {\em k} & number of iterates of the Poincare map \\
\hline
\mbox{\tt in}  & {\em p} & fixed point \$p=(x,p\_\-x)\$ \\
\hline
\mbox{\tt in}  & {\em v} & eigenvector associated to unstable (or stable) direction \\
\hline
\mbox{\tt in}  & {\em lambda} & eigenvalue associated to unstable (or stable) direction\\
\hline
\mbox{\tt in}  & {\em stable} & flag indicating unstable manifold (stable=0) or stable manifold (stable=1).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns optimal linear displacement along the manifold \$h\$. 
\end{DoxyReturn}


Here is the call graph for this function:


