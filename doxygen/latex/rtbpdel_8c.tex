\hypertarget{rtbpdel_8c}{
\section{/home/pau/research/splitting\_\-prog/rtbp\_\-del/rtbpdel.c File Reference}
\label{rtbpdel_8c}\index{/home/pau/research/splitting\_\-prog/rtbp\_\-del/rtbpdel.c@{/home/pau/research/splitting\_\-prog/rtbp\_\-del/rtbpdel.c}}
}


Restricted Three Body Problem equations in Delaunay coordinates.  


{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$assert.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-errno.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-roots.h$>$}\par
{\ttfamily \#include \char`\"{}rtbpdel.h\char`\"{}}\par
Include dependency graph for rtbpdel.c:
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtrig__params}{trig\_\-params}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{rtbpdel_8c_a226a8916611792d8e33132691168ab9a}{
double {\bfseries trig} (double u, void $\ast$params)}
\label{rtbpdel_8c_a226a8916611792d8e33132691168ab9a}

\item 
\hypertarget{rtbpdel_8c_a57738b2549053e4e75f83952bd105f9c}{
double {\bfseries eccentric} (double e, double l)}
\label{rtbpdel_8c_a57738b2549053e4e75f83952bd105f9c}

\item 
\hypertarget{rtbpdel_8c_a09e1e661b6c87725344fcf1cd0103d42}{
double {\bfseries Delta} (double r, double v, double g)}
\label{rtbpdel_8c_a09e1e661b6c87725344fcf1cd0103d42}

\item 
\hypertarget{rtbpdel_8c_a005c3634542493fa198448da00eb518a}{
double {\bfseries N\_\-func} (double r, double v, double g)}
\label{rtbpdel_8c_a005c3634542493fa198448da00eb518a}

\item 
\hypertarget{rtbpdel_8c_a820d87be89387752b79abc2f04101cea}{
double {\bfseries R} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, const double $\ast$x)}
\label{rtbpdel_8c_a820d87be89387752b79abc2f04101cea}

\item 
\hypertarget{rtbpdel_8c_a79a165067de341c62d05d6b13a9b583c}{
double {\bfseries Hamilt\_\-del} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, const double $\ast$x)}
\label{rtbpdel_8c_a79a165067de341c62d05d6b13a9b583c}

\item 
\hypertarget{rtbpdel_8c_a3d81ed8feaada2c59974b3129644c104}{
double {\bfseries dN\_\-r} (double r, double v, double g)}
\label{rtbpdel_8c_a3d81ed8feaada2c59974b3129644c104}

\item 
\hypertarget{rtbpdel_8c_a94e4e04cdbfc7721b851e4033ea2fe3f}{
double {\bfseries dN\_\-v} (double r, double v, double g)}
\label{rtbpdel_8c_a94e4e04cdbfc7721b851e4033ea2fe3f}

\item 
int \hyperlink{rtbpdel_8c_a82a8da3bffd2d54c6215c8d92a42b846}{rtbp\_\-del} (double t, const double $\ast$x, double $\ast$y, void $\ast$params)
\item 
int \hyperlink{rtbpdel_8c_ab68360cde7054095ebe0c8682bdaa3b8}{dot\_\-l} (const double $\ast$x, double $\ast$dl, void $\ast$params)
\item 
int \hyperlink{rtbpdel_8c_ae8c62a9a7573e8672ead34056c6c1214}{f0} (const double $\ast$x, double $\ast$res, void $\ast$params)
\item 
\hypertarget{rtbpdel_8c_a9a79b546967ac22047a354b6adf4be94}{
double {\bfseries re\_\-dDHell} (const double $\ast$x, void $\ast$params)}
\label{rtbpdel_8c_a9a79b546967ac22047a354b6adf4be94}

\item 
\hypertarget{rtbpdel_8c_a5fd7287943d6743d792b56e724ce99ee}{
double {\bfseries im\_\-dDHell} (const double $\ast$x, void $\ast$params)}
\label{rtbpdel_8c_a5fd7287943d6743d792b56e724ce99ee}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Restricted Three Body Problem equations in Delaunay coordinates. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/03-\/26 22:26:03 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{rtbpdel_8c_ab68360cde7054095ebe0c8682bdaa3b8}{
\index{rtbpdel.c@{rtbpdel.c}!dot\_\-l@{dot\_\-l}}
\index{dot\_\-l@{dot\_\-l}!rtbpdel.c@{rtbpdel.c}}
\subsubsection[{dot\_\-l}]{\setlength{\rightskip}{0pt plus 5cm}int dot\_\-l (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{x, }
\item[{double $\ast$}]{dl, }
\item[{void $\ast$}]{params}
\end{DoxyParamCaption}
)}}
\label{rtbpdel_8c_ab68360cde7054095ebe0c8682bdaa3b8}
\$l'\$-\/component of Restricted Three Body Problem equations in Delaunay coordinates.

\begin{DoxyAuthor}{Authors}
Marcel Guardia and Pau Roldan
\end{DoxyAuthor}
The function computes the \$l'\$-\/component of the vectorfield of the RTBP at a point named \char`\"{}x\char`\"{}: \[ \frac{d}{dt} l = L^{-3}+\mu\partial_L \Delta H_{circ}(x). \]

We normalize $\ell$ between 0 and 2 to compute the vectorfield. This is done so that function \char`\"{}eccentric\char`\"{} is more precise.


\begin{DoxyParams}[2]{Parameters}
\mbox{\tt in}  &  & {\em x} & point in phase space, 4 coordinates: (l,L,g,G).\\
\hline
\mbox{\tt out}  & dl & {\em \$l,'\$-\/component} & of the vectorfield at x.\\
\hline
\mbox{\tt in}  &  & {\em params} & pointer to the parameter of the system: the mass ratio \char`\"{}mu\char`\"{}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code of the function (success/error).
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em GSL\_\-SUCCESS} & success.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\hyperlink{rtbpdel_8h_a82a8da3bffd2d54c6215c8d92a42b846}{rtbp\_\-del} 
\end{DoxySeeAlso}


Here is the caller graph for this function:


\hypertarget{rtbpdel_8c_ae8c62a9a7573e8672ead34056c6c1214}{
\index{rtbpdel.c@{rtbpdel.c}!f0@{f0}}
\index{f0@{f0}!rtbpdel.c@{rtbpdel.c}}
\subsubsection[{f0}]{\setlength{\rightskip}{0pt plus 5cm}int f0 (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{x, }
\item[{double $\ast$}]{res, }
\item[{void $\ast$}]{params}
\end{DoxyParamCaption}
)}}
\label{rtbpdel_8c_ae8c62a9a7573e8672ead34056c6c1214}
Compute the function f0.

The function computes the function f0, defined as \[ f0(x) = \frac{3-L^{-3}-\mu\partial_L \Delta H_{circ}(x)} {3(L^{-3}+\mu\partial_L \Delta H_{circ}(x))} = \frac{3-l'(x)}{3 l'(x)}. \] at a point named \char`\"{}x\char`\"{}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & point in phase space, 4 coordinates: (l,L,g,G). \\
\hline
\mbox{\tt out}  & {\em res} & value of \$f0\$ (output)\\
\hline
\mbox{\tt in}  & {\em params} & pointer to the parameter of the system: the mass ratio \char`\"{}mu\char`\"{}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code of the function (success/error)
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em GSL\_\-SUCCESS} & success.\\
\hline
\end{DoxyRetVals}
\begin{DoxySeeAlso}{See also}
\hyperlink{inner__circ_8h_add386ab1cbaa441219d25f4b52e2f53d}{integrand\_\-omega\_\-in} 
\end{DoxySeeAlso}


Here is the call graph for this function:




Here is the caller graph for this function:


\hypertarget{rtbpdel_8c_a82a8da3bffd2d54c6215c8d92a42b846}{
\index{rtbpdel.c@{rtbpdel.c}!rtbp\_\-del@{rtbp\_\-del}}
\index{rtbp\_\-del@{rtbp\_\-del}!rtbpdel.c@{rtbpdel.c}}
\subsubsection[{rtbp\_\-del}]{\setlength{\rightskip}{0pt plus 5cm}int rtbp\_\-del (
\begin{DoxyParamCaption}
\item[{double}]{t, }
\item[{const double $\ast$}]{x, }
\item[{double $\ast$}]{y, }
\item[{void $\ast$}]{params}
\end{DoxyParamCaption}
)}}
\label{rtbpdel_8c_a82a8da3bffd2d54c6215c8d92a42b846}
Restricted Three Body Problem equations in Delaunay coordinates

\begin{DoxyAuthor}{Authors}
Marcel Guardia and Pau Roldan
\end{DoxyAuthor}
The function computes the vectorfield of the RTBP at a point named \char`\"{}x\char`\"{}. Specifically, we use the equations of motion of the planar circular RTBP in Delaunay coordinates (l,L,g,G), in the rotating (synodic) coordinate system.

We follow the convention to place the large mass (Sun) to the left of the origin, and the small mass (Jupiter) to the right. This is opposite to the usual astrodynamics convention.

This system is Hamiltonian, with Hamiltonian function \[ H(l,L,g,G) = -1/(2L^2) - G + R, \] where R is the perturbation relative to the two body problem. See Szebehelly, page 364. See Marcel's notes \char`\"{}Inner and outer dynamics\char`\"{}. See also my hand-\/written notes \char`\"{}RTBP vector field in Delaunay\char`\"{}. The function sets the value of the vectorfield in the variable \char`\"{}y\char`\"{}. It returns a status code (success/error).

We normalize \$\$ between 0 and 2 to compute the vectorfield. This is done so that function \char`\"{}eccentric\char`\"{} is more precise.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em t} & adimensional time at which the vectorfield is evaluated. Since this is an autonomous ODE (does not depend on time), this parameter is not used.\\
\hline
\mbox{\tt in}  & {\em x\mbox{[}4\mbox{]}} & point in phase space, 4 coordinates: (l,L,g,G).\\
\hline
\mbox{\tt out}  & {\em y\mbox{[}4\mbox{]}} & vectorfield at (t,x), 4 coordinates: d/dt(l,L,g,G).\\
\hline
\mbox{\tt in}  & {\em params} & pointer to the parameter of the system: the mass ratio \char`\"{}mu\char`\"{}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code of the function (success/error).
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em GSL\_\-SUCCESS} & success. \\
\hline
\end{DoxyRetVals}


Here is the caller graph for this function:


