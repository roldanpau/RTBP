\hypertarget{portbpsym_8c}{
\section{/home/pau/research/splitting\_\-prog/portbp/portbpsym.c File Reference}
\label{portbpsym_8c}\index{/home/pau/research/splitting\_\-prog/portbp/portbpsym.c@{/home/pau/research/splitting\_\-prog/portbp/portbpsym.c}}
}


Find a symmetric periodic orbit of the RTBP.  


{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-errno.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-vector.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-roots.h$>$}\par
{\ttfamily \#include $<$prtbp\_\-2d.h$>$}\par
{\ttfamily \#include $<$dprtbp\_\-2d.h$>$}\par
{\ttfamily \#include $<$rtbp.h$>$}\par
Include dependency graph for portbpsym.c:
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structdparams}{dparams}
\begin{DoxyCompactList}\small\item\em parameters to function \char`\"{}dist\char`\"{} \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{portbpsym_8c_a95875f6b4c750810b0730920ff3970da}{
double {\bfseries perp} (double x, void $\ast$params)}
\label{portbpsym_8c_a95875f6b4c750810b0730920ff3970da}

\item 
\hypertarget{portbpsym_8c_a3e1bd5d1e6b79fa28e6e017c832b6aa4}{
double {\bfseries perp\_\-df} (double x, void $\ast$params)}
\label{portbpsym_8c_a3e1bd5d1e6b79fa28e6e017c832b6aa4}

\item 
\hypertarget{portbpsym_8c_ad323f1ee685619c54d9d656b68e293cc}{
void {\bfseries perp\_\-fdf} (double x, void $\ast$params, double $\ast$y, double $\ast$dy)}
\label{portbpsym_8c_ad323f1ee685619c54d9d656b68e293cc}

\item 
\hypertarget{portbpsym_8c_ae3ba467d35c7d118c8e17c7b5b2b7e6a}{
void {\bfseries print\_\-state\_\-fdf} (size\_\-t iter, gsl\_\-root\_\-fdfsolver $\ast$s, double px)}
\label{portbpsym_8c_ae3ba467d35c7d118c8e17c7b5b2b7e6a}

\item 
int \hyperlink{portbpsym_8c_a8e1962a71e795b445785e67c126e41bf}{portbpsym} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, double H, int k, double $\ast$root)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{portbpsym_8c_a55148a66858b3d594bd3abcd0af92681}{
const double \hyperlink{portbpsym_8c_a55148a66858b3d594bd3abcd0af92681}{TOL\_\-PERP} = 1.e-\/13}
\label{portbpsym_8c_a55148a66858b3d594bd3abcd0af92681}

\begin{DoxyCompactList}\small\item\em desired accuracy for perpendicular condition PX=0 \item\end{DoxyCompactList}\item 
\hypertarget{portbpsym_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{
const int \hyperlink{portbpsym_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{MAXITER} = 100}
\label{portbpsym_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}

\begin{DoxyCompactList}\small\item\em max number of solver iterations \item\end{DoxyCompactList}\item 
\hypertarget{portbpsym_8c_abfdef228183d6955842795435842261b}{
const int {\bfseries ERR\_\-SOLVER\_\-STUCK} = 1}
\label{portbpsym_8c_abfdef228183d6955842795435842261b}

\item 
\hypertarget{portbpsym_8c_a6ab52e062fe0cdf9fc1c228670d4e981}{
const int {\bfseries ERR\_\-MAXITER\_\-PO} = 2}
\label{portbpsym_8c_a6ab52e062fe0cdf9fc1c228670d4e981}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Find a symmetric periodic orbit of the RTBP. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/02-\/08 15:01:07 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{portbpsym_8c_a8e1962a71e795b445785e67c126e41bf}{
\index{portbpsym.c@{portbpsym.c}!portbpsym@{portbpsym}}
\index{portbpsym@{portbpsym}!portbpsym.c@{portbpsym.c}}
\subsubsection[{portbpsym}]{\setlength{\rightskip}{0pt plus 5cm}int portbpsym (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double $\ast$}]{root}
\end{DoxyParamCaption}
)}}
\label{portbpsym_8c_a8e1962a71e795b445785e67c126e41bf}
Find a symmetric periodic orbit of the RTBP.

This function refines a trajectory of the RTBP which is close to a symmetric periodic orbit, until a true periodic orbit is obtained. We look for an orbit that is symmetric wrt the horizontal axis, with initial condition corresponding to cutting the horizontal axis perpendicularly (x,px)=(x,0). After integrating for ONE FULL period, we request that the orbit cuts again the horizontal axis perpendiculary, i.e. with final condition (X,PX)=(X,0).

Let \char`\"{}perp\char`\"{} be the function that tests the perpendicular condition: given init.cond. x, integrates for one full period and returns the final cond. PX. We need to solve the function perp(x) := PX = 0. To refine the (approximate) root to this function, we use a 1D Newton method.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter of RTBP. \\
\hline
\mbox{\tt in}  & {\em sec} & Poincare section \\
\hline
\mbox{\tt in}  & {\em H} & energy value where we will look for periodic orbit \\
\hline
\mbox{\tt in}  & {\em k} & number of cuts with section\\
\hline
\mbox{\tt in,out}  & {\em root} & On entry, approximate root to the \char`\"{}perp\char`\"{} function. On exit, it contains the true root (up to some tolerance TOL\_\-PERP).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a non-\/zero error code to indicate an error and 0 to indicate success. If an error is encountered, \char`\"{}pt\char`\"{} is set to the best approximation to the fixed point found so far, and the function returns a non-\/zero value:
\end{DoxyReturn}
ERR\_\-SOLVER\_\-STUCK Solver is unable to further improve the solution (up to desired accuracy TOL\_\-FIXED\_\-PT).

ERR\_\-MAXITER\_\-PO Maximum number of solver iterations MAXITER reached without converging to a fixed point while looking for periodic orbit. 

Here is the caller graph for this function:


