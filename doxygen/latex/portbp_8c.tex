\hypertarget{portbp_8c}{
\section{/home/pau/research/splitting\_\-prog/portbp/portbp.c File Reference}
\label{portbp_8c}\index{/home/pau/research/splitting\_\-prog/portbp/portbp.c@{/home/pau/research/splitting\_\-prog/portbp/portbp.c}}
}


Find a periodic orbit of the RTBP.  


{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-errno.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-vector.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-multiroots.h$>$}\par
{\ttfamily \#include $<$prtbp.h$>$}\par
{\ttfamily \#include $<$prtbp\_\-2d.h$>$}\par
{\ttfamily \#include $<$dprtbp\_\-2d.h$>$}\par
{\ttfamily \#include $<$rtbp.h$>$}\par
Include dependency graph for portbp.c:
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structdparams}{dparams}
\begin{DoxyCompactList}\small\item\em parameters to function \char`\"{}dist\char`\"{} \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{portbp_8c_a1b0c71d1b0eecadc40dce835e2299aa3}{
int {\bfseries dist} (const gsl\_\-vector $\ast$ic, void $\ast$params, gsl\_\-vector $\ast$f)}
\label{portbp_8c_a1b0c71d1b0eecadc40dce835e2299aa3}

\item 
\hypertarget{portbp_8c_a50770c8c2b90f254ac100243fb0ed6f2}{
int {\bfseries dist\_\-df} (const gsl\_\-vector $\ast$ic, void $\ast$params, gsl\_\-matrix $\ast$J)}
\label{portbp_8c_a50770c8c2b90f254ac100243fb0ed6f2}

\item 
\hypertarget{portbp_8c_a1bd207c6520135983a4aeeb8c007e1ef}{
int {\bfseries dist\_\-fdf} (const gsl\_\-vector $\ast$ic, void $\ast$params, gsl\_\-vector $\ast$f, gsl\_\-matrix $\ast$J)}
\label{portbp_8c_a1bd207c6520135983a4aeeb8c007e1ef}

\item 
\hypertarget{portbp_8c_a272a7d500dc66b4196edcf022c4a1b63}{
void {\bfseries print\_\-state} (size\_\-t iter, gsl\_\-multiroot\_\-fdfsolver $\ast$s)}
\label{portbp_8c_a272a7d500dc66b4196edcf022c4a1b63}

\item 
int \hyperlink{portbp_8c_ac63eb83626cf0535b9fa75f69f38232e}{portbp} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, double H, int k, double pt\mbox{[}2\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{portbp_8c_a1a77a205b6781894f852e6b66a329e6a}{
const double \hyperlink{portbp_8c_a1a77a205b6781894f852e6b66a329e6a}{TOL\_\-FIXED\_\-PT} = 1.e-\/13}
\label{portbp_8c_a1a77a205b6781894f852e6b66a329e6a}

\begin{DoxyCompactList}\small\item\em desired accuracy for fixed point \item\end{DoxyCompactList}\item 
\hypertarget{portbp_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{
const int \hyperlink{portbp_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{MAXITER} = 100}
\label{portbp_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}

\begin{DoxyCompactList}\small\item\em max number of solver iterations \item\end{DoxyCompactList}\item 
\hypertarget{portbp_8c_abfdef228183d6955842795435842261b}{
const int {\bfseries ERR\_\-SOLVER\_\-STUCK} = 1}
\label{portbp_8c_abfdef228183d6955842795435842261b}

\item 
\hypertarget{portbp_8c_a6ab52e062fe0cdf9fc1c228670d4e981}{
const int {\bfseries ERR\_\-MAXITER\_\-PO} = 2}
\label{portbp_8c_a6ab52e062fe0cdf9fc1c228670d4e981}

\item 
\hypertarget{portbp_8c_a4528971ecd08e0bd42c1062131c191f8}{
const int {\bfseries ERR\_\-POINCARE\_\-MAP} = 1}
\label{portbp_8c_a4528971ecd08e0bd42c1062131c191f8}

\item 
\hypertarget{portbp_8c_a6c780d2239d73dd68c3748624faf7183}{
const int {\bfseries ERR\_\-DPOINCARE\_\-MAP} = 1}
\label{portbp_8c_a6c780d2239d73dd68c3748624faf7183}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Find a periodic orbit of the RTBP. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/02-\/08 15:01:07 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{portbp_8c_ac63eb83626cf0535b9fa75f69f38232e}{
\index{portbp.c@{portbp.c}!portbp@{portbp}}
\index{portbp@{portbp}!portbp.c@{portbp.c}}
\subsubsection[{portbp}]{\setlength{\rightskip}{0pt plus 5cm}int portbp (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double}]{pt\mbox{[}2\mbox{]}}
\end{DoxyParamCaption}
)}}
\label{portbp_8c_ac63eb83626cf0535b9fa75f69f38232e}
Find a periodic orbit of the RTBP.

This function refines a trajectory of the RTBP which is close to a periodic orbit, until a true periodic orbit is obtained. We look for a periodic orbit in the given energy manifold \$H=H\_\-0\$. Consider the Poincare section \char`\"{}sec\char`\"{} in the autonomous RTBP. We look for the periodic periodic orbit as a fixed point of the \$k\$-\/th iterate \$P$^\wedge$\{k\}(x)\$ of the Poincare first return map to this section. To refine the (approximate) fixed point, we use a Newton-\/like method.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter of RTBP. \\
\hline
\mbox{\tt in}  & {\em sec} & Poincare section \\
\hline
\mbox{\tt in}  & {\em H} & energy value where we will look for periodic orbit \\
\hline
\mbox{\tt in}  & {\em k} & number of cuts with section\\
\hline
\mbox{\tt in,out}  & {\em pt} & On entry, approximate fixed point of the \$k\$-\/th iterate \$P$^\wedge$\{k\}(x)\$. On exit, it contains the true fixed point.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a non-\/zero error code to indicate an error and 0 to indicate success. If an error is encountered, \char`\"{}pt\char`\"{} is set to the best approximation to the fixed point found so far, and the function returns a non-\/zero value:
\end{DoxyReturn}
ERR\_\-SOLVER\_\-STUCK Solver is unable to further improve the solution (up to desired accuracy TOL\_\-FIXED\_\-PT).

ERR\_\-MAXITER\_\-PO Maximum number of solver iterations MAXITER reached without converging to a fixed point while looking for periodic orbit. 