\hypertarget{prtbp_8c}{
\section{/home/pau/research/splitting\_\-prog/prtbp/prtbp.c File Reference}
\label{prtbp_8c}\index{/home/pau/research/splitting\_\-prog/prtbp/prtbp.c@{/home/pau/research/splitting\_\-prog/prtbp/prtbp.c}}
}


Poincare map of the Restricted Three Body Problem.  


{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$stdbool.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-errno.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-roots.h$>$}\par
{\ttfamily \#include $<$frtbp.h$>$}\par
{\ttfamily \#include $<$rtbp.h$>$}\par
{\ttfamily \#include \char`\"{}prtbp.h\char`\"{}}\par
Include dependency graph for prtbp.c:
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structinter__f__params}{inter\_\-f\_\-params}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{prtbp_8c_a5282b311cc603fb3ca5c6c0624f3a353}{
int {\bfseries inter} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, double epsabs, double x\mbox{[}DIM\mbox{]}, double t0, double t1, double $\ast$t)}
\label{prtbp_8c_a5282b311cc603fb3ca5c6c0624f3a353}

\item 
\hypertarget{prtbp_8c_a666733b5ffda7d728d3524e395f980b5}{
double {\bfseries inter\_\-f} (double t, void $\ast$p)}
\label{prtbp_8c_a666733b5ffda7d728d3524e395f980b5}

\item 
bool \hyperlink{prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf}{onsection} (section\_\-t sec, double a\mbox{[}DIM\mbox{]}, int $\ast$sign)
\item 
bool \hyperlink{prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65}{crossing} (section\_\-t sec, double a\mbox{[}DIM\mbox{]}, double b\mbox{[}DIM\mbox{]}, int $\ast$sign)
\item 
int \hyperlink{prtbp_8c_ae2068a782d6e50d63718fec38d77e31f}{prtbp} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, int cuts, double x\mbox{[}DIM\mbox{]}, double $\ast$ti)
\item 
int \hyperlink{prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c}{prtbp\_\-inv} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, section\_\-t sec, int cuts, double x\mbox{[}DIM\mbox{]}, double $\ast$ti)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{prtbp_8c_ac450b8001e59c6e9d91c135a2154944a}{
const double \hyperlink{prtbp_8c_ac450b8001e59c6e9d91c135a2154944a}{POINCARE\_\-TOL} = 1.e-\/16}
\label{prtbp_8c_ac450b8001e59c6e9d91c135a2154944a}

\begin{DoxyCompactList}\small\item\em error bound (tolerance) for Poincare map \item\end{DoxyCompactList}\item 
\hypertarget{prtbp_8c_a8238331f6ef31220593dd74611d28972}{
const double \hyperlink{prtbp_8c_a8238331f6ef31220593dd74611d28972}{SHORT\_\-TIME} = 0.01}
\label{prtbp_8c_a8238331f6ef31220593dd74611d28972}

\begin{DoxyCompactList}\small\item\em integration \char`\"{}step\char`\"{} for prtbp \item\end{DoxyCompactList}\item 
\hypertarget{prtbp_8c_adc64fc3ca33ccf1fb82dc8967763f4e5}{
const int {\bfseries ERR\_\-MAXITER} = 1}
\label{prtbp_8c_adc64fc3ca33ccf1fb82dc8967763f4e5}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Poincare map of the Restricted Three Body Problem. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/03-\/26 22:22:14 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65}{
\index{prtbp.c@{prtbp.c}!crossing@{crossing}}
\index{crossing@{crossing}!prtbp.c@{prtbp.c}}
\subsubsection[{crossing}]{\setlength{\rightskip}{0pt plus 5cm}bool crossing (
\begin{DoxyParamCaption}
\item[{section\_\-t}]{sec, }
\item[{double}]{a\mbox{[}DIM\mbox{]}, }
\item[{double}]{b\mbox{[}DIM\mbox{]}, }
\item[{int $\ast$}]{sign}
\end{DoxyParamCaption}
)}}
\label{prtbp_8c_ab754a9e94e62d1400859c5aa952e8d65}
Let \$a\$ and \$b\$ be two consecutive points in an orbit. This function determines if the trajectory from \$a\$ to \$b\$ does cross the poincare section sec or not.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sec} & type of Poincare section (sec = SEC1 or SEC2). \\
\hline
\mbox{\tt in}  & {\em a} & First point, 4 coordinates: (x, y, p\_\-x, p\_\-y). \\
\hline
\mbox{\tt in}  & {\em b} & Second point, 4 coordinates: (x, y, p\_\-x, p\_\-y).\\
\hline
\mbox{\tt in,out}  & {\em sign} & (pointer to) sign of previous intersection with x axis (sign = +1 if x$>$0 or sign = -\/1 if x$<$0).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if trajectory cuts section, false if it does not. 
\end{DoxyReturn}


Here is the caller graph for this function:


\hypertarget{prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf}{
\index{prtbp.c@{prtbp.c}!onsection@{onsection}}
\index{onsection@{onsection}!prtbp.c@{prtbp.c}}
\subsubsection[{onsection}]{\setlength{\rightskip}{0pt plus 5cm}bool onsection (
\begin{DoxyParamCaption}
\item[{section\_\-t}]{sec, }
\item[{double}]{a\mbox{[}DIM\mbox{]}, }
\item[{int $\ast$}]{sign}
\end{DoxyParamCaption}
)}}
\label{prtbp_8c_a6cced3544f6ddfed54297f12824ef0cf}
This function determines if the point A is exactly on the section.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sec} & type of Poincare section (sect = SEC1 or SEC2). \\
\hline
\mbox{\tt in}  & {\em a} & point, 4 coordinates: (x, y, p\_\-x, p\_\-y).\\
\hline
\mbox{\tt in,out}  & {\em sign} & (pointer to) sign of previous intersection with x axis (sign = +1 if x$>$0 or sign = -\/1 if x$<$0).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if point \$a\$ is exactly on section, false if it is not. 
\end{DoxyReturn}


Here is the caller graph for this function:


\hypertarget{prtbp_8c_ae2068a782d6e50d63718fec38d77e31f}{
\index{prtbp.c@{prtbp.c}!prtbp@{prtbp}}
\index{prtbp@{prtbp}!prtbp.c@{prtbp.c}}
\subsubsection[{prtbp}]{\setlength{\rightskip}{0pt plus 5cm}int prtbp (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{int}]{cuts, }
\item[{double}]{x\mbox{[}DIM\mbox{]}, }
\item[{double $\ast$}]{ti}
\end{DoxyParamCaption}
)}}
\label{prtbp_8c_ae2068a782d6e50d63718fec38d77e31f}
Poincare map of the Restricted Three Body Problem.

Consider the RTBP in rotating coordinates. Let S be the Poincare section SEC1 or SEC2, corresponding to \{y=0, v\_\-y$>$0\} or \{y=0, v\_\-y$<$0\}. Let \$x\$ be a point in the section, and suppose that flow at \$x\$ is transversal to the section. Compute the n-\/th iterate of the Poincare map \$P$^\wedge$n(x)\$ of the RTBP. This procedure also computes, as a side product, the integration time to intersect the Poincare section \char`\"{}n\char`\"{} times.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter for the RTBP \\
\hline
\mbox{\tt in}  & {\em sec} & type of Poincare section (sec = SEC1 or SEC2).\\
\hline
\mbox{\tt in}  & {\em cuts} & number of iterates of the Poincare map (cuts=n: n cuts with the Poincare section).\\
\hline
\mbox{\tt in,out}  & {\em x} & Initial point, 4 coordinates: (X, Y, P\_\-X, P\_\-Y). On return of the this function, it holds the image point \$P$^\wedge$n(x)\$.\\
\hline
\mbox{\tt out}  & {\em ti} & On return, it holds the integration time to intersect the Poincare section \char`\"{}n\char`\"{} times.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a non-\/zero error code to indicate an error and 0 to indicate success. If an integration error is encountered, the function returns a non-\/zero value.
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
We are only interested in orbits that go around the origin. For some values of the energy, the orbit has \char`\"{}contractible\char`\"{} loops, which we want to avoid. For this, we impose that TWO CONSECUTIVE ITERATES do NOT lie both to the right or to the left of the origin.

On successful return of this function, the point \$x\$ is exactly on the section, i.e. we set coordinate \$y\$ exactly equal to zero. 
\end{DoxyRemark}


Here is the call graph for this function:


\hypertarget{prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c}{
\index{prtbp.c@{prtbp.c}!prtbp\_\-inv@{prtbp\_\-inv}}
\index{prtbp\_\-inv@{prtbp\_\-inv}!prtbp.c@{prtbp.c}}
\subsubsection[{prtbp\_\-inv}]{\setlength{\rightskip}{0pt plus 5cm}int prtbp\_\-inv (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{section\_\-t}]{sec, }
\item[{int}]{cuts, }
\item[{double}]{x\mbox{[}DIM\mbox{]}, }
\item[{double $\ast$}]{ti}
\end{DoxyParamCaption}
)}}
\label{prtbp_8c_a518d5cd6341e8ea73f37ed1a9338fb8c}
Inverse Poincare map of the Restricted Three Body Problem.

Consider the RTBP in rotating coordinates. Let S be the Poincare section SEC1 or SEC2, corresponding to \{y=0, v\_\-y$>$0\} or \{y=0, v\_\-y$<$0\}. Let \$x\$ be a point in the section, and suppose that flow at \$x\$ is transversal to the section. Compute the n-\/th iterate of the inverse Poincare map \$P$^\wedge$\{-\/n\}(x)\$ of the RTBP. This procedure also computes, as a side product, the integration time to intersect the Poincare section \char`\"{}n\char`\"{} times.

NOTE: We are only interested in orbits that go around the origin. For some values of the energy, the orbit has \char`\"{}contractible\char`\"{} loops, which we want to avoid. For this, we impose that TWO CONSECUTIVE ITERATES do NOT lie both to the right or to the left of the origin.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter for the RTBP \\
\hline
\mbox{\tt in}  & {\em sec} & type of Poincare section (sec = SEC1 or SEC2).\\
\hline
\mbox{\tt in}  & {\em cuts} & number of iterates of the Poincare map (cuts=n: n cuts with the Poincare section).\\
\hline
\mbox{\tt in,out}  & {\em x} & Initial point, 4 coordinates: (X, Y, P\_\-X, P\_\-Y). On return of the this function, it holds the image point \$P$^\wedge$\{-\/n\}(x)\$.\\
\hline
\mbox{\tt out}  & {\em ti} & On return, it holds the integration time to intersect the Poincare section \char`\"{}n\char`\"{} times. Since we are computing the inverse Poincare map, this integration time \char`\"{}ti\char`\"{} must be negative.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a non-\/zero error code to indicate an error and 0 to indicate success. If an integration error is encountered, the function returns a non-\/zero value. 
\end{DoxyReturn}


Here is the call graph for this function:


