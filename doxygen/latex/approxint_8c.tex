\hypertarget{approxint_8c}{
\section{/home/pau/research/splitting\_\-prog/approxint/approxint.c File Reference}
\label{approxint_8c}\index{/home/pau/research/splitting\_\-prog/approxint/approxint.c@{/home/pau/research/splitting\_\-prog/approxint/approxint.c}}
}


Approximate Intersection of Invariant Manifolds.  


{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$stdbool.h$>$}\par
{\ttfamily \#include $<$string.h$>$}\par
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$assert.h$>$}\par
{\ttfamily \#include $<$prtbp\_\-2d.h$>$}\par
{\ttfamily \#include $<$disc.h$>$}\par
Include dependency graph for approxint.c:
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{approxint_8c_a22646e4615c12fda94631d65ae61a5cc}{
int {\bfseries u\_\-i} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, double H, int k, double z\mbox{[}2\mbox{]}, double a, double $\ast$l, int $\ast$idx)}
\label{approxint_8c_a22646e4615c12fda94631d65ae61a5cc}

\item 
\hypertarget{approxint_8c_aa89f50db0ba8e30cb2eb4f85e7862dbf}{
int {\bfseries s\_\-i} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, double H, int k, double z\mbox{[}2\mbox{]}, double a, double $\ast$l, int $\ast$idx)}
\label{approxint_8c_aa89f50db0ba8e30cb2eb4f85e7862dbf}

\item 
int \hyperlink{approxint_8c_af4aadb9c4979e9a58d7cb4a35cee9b2c}{approxint\_\-unst} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, double H, int k, double p\mbox{[}2\mbox{]}, double v\mbox{[}2\mbox{]}, double lambda, double h, double a, int $\ast$piter, double $\ast$h\_\-1, double $\ast$h\_\-2, double z\mbox{[}2\mbox{]})
\item 
int \hyperlink{approxint_8c_ab13d7daeb3a10d4b204d83bf38e707d0}{approxint\_\-st} (double \hyperlink{frtbp_8c_a74577585cf12d1712ab9c57616d49205}{mu}, double H, int k, double p\mbox{[}2\mbox{]}, double v\mbox{[}2\mbox{]}, double lambda, double h, double a, int $\ast$piter, double $\ast$h\_\-1, double $\ast$h\_\-2, double z\mbox{[}2\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{approxint_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{
const int \hyperlink{approxint_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}{MAXITER} = 40}
\label{approxint_8c_a6c23fbf2bdbc02406e33ac7cdf7ada2b}

\begin{DoxyCompactList}\small\item\em Max number of iterations of unst segment before we give up looking for intersection. \item\end{DoxyCompactList}\item 
\hypertarget{approxint_8c_a94087ddaa6251837c08fcfd59a4ded74}{
const int \hyperlink{approxint_8c_a94087ddaa6251837c08fcfd59a4ded74}{NPOINTS} = 100}
\label{approxint_8c_a94087ddaa6251837c08fcfd59a4ded74}

\begin{DoxyCompactList}\small\item\em Number of points in the discretization of unst segment. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Approximate Intersection of Invariant Manifolds. \begin{DoxyParagraph}{Author:}
roldan 
\end{DoxyParagraph}
\begin{DoxyParagraph}{Date:}
2013-\/03-\/26 22:10:02 
\end{DoxyParagraph}


\subsection{Function Documentation}
\hypertarget{approxint_8c_ab13d7daeb3a10d4b204d83bf38e707d0}{
\index{approxint.c@{approxint.c}!approxint\_\-st@{approxint\_\-st}}
\index{approxint\_\-st@{approxint\_\-st}!approxint.c@{approxint.c}}
\subsubsection[{approxint\_\-st}]{\setlength{\rightskip}{0pt plus 5cm}int approxint\_\-st (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double}]{p\mbox{[}2\mbox{]}, }
\item[{double}]{v\mbox{[}2\mbox{]}, }
\item[{double}]{lambda, }
\item[{double}]{h, }
\item[{double}]{a, }
\item[{int $\ast$}]{piter, }
\item[{double $\ast$}]{h\_\-1, }
\item[{double $\ast$}]{h\_\-2, }
\item[{double}]{z\mbox{[}2\mbox{]}}
\end{DoxyParamCaption}
)}}
\label{approxint_8c_ab13d7daeb3a10d4b204d83bf38e707d0}
Approximate intersection of stable invariant manifold with symmetry line.

Exactly as \hyperlink{approxint_8h_af4aadb9c4979e9a58d7cb4a35cee9b2c}{approxint\_\-unst}. \hypertarget{approxint_8c_af4aadb9c4979e9a58d7cb4a35cee9b2c}{
\index{approxint.c@{approxint.c}!approxint\_\-unst@{approxint\_\-unst}}
\index{approxint\_\-unst@{approxint\_\-unst}!approxint.c@{approxint.c}}
\subsubsection[{approxint\_\-unst}]{\setlength{\rightskip}{0pt plus 5cm}int approxint\_\-unst (
\begin{DoxyParamCaption}
\item[{double}]{mu, }
\item[{double}]{H, }
\item[{int}]{k, }
\item[{double}]{p\mbox{[}2\mbox{]}, }
\item[{double}]{v\mbox{[}2\mbox{]}, }
\item[{double}]{lambda, }
\item[{double}]{h, }
\item[{double}]{a, }
\item[{int $\ast$}]{piter, }
\item[{double $\ast$}]{h\_\-1, }
\item[{double $\ast$}]{h\_\-2, }
\item[{double}]{z\mbox{[}2\mbox{]}}
\end{DoxyParamCaption}
)}}
\label{approxint_8c_af4aadb9c4979e9a58d7cb4a35cee9b2c}
Approximate intersection of unstable invariant manifold with symmetry line.

Let \$p\$ be a hyperbolic fixed point for the 2D map $\mathcal{P}: \Sigma_- \to \Sigma_-$. For definiteness, we assume that \$p\$ is located above the \$p\_\-x=0\$ axis.

Assume that $\lambda$ is the unstable eigenvalue, with $\lambda>1$. Let \$v\$ be the unstable eigenvector for the eigenvalue $\lambda$. For definiteness, we assume that \$v=(x,p\_\-x)\$ points \char`\"{}to the right\char`\"{}, i.e. we assume that the first component of \$v\$ is \$x$>$0\$, but we could use the other branch of the manifold. Let \$W$^\wedge$u(p)\$ be the unstable manifold of \$p\$. Let \$p\_\-x=a\$ be a line parallel to the \$x\$ axis.

This function computes an approximation to the \char`\"{}first\char`\"{} intersection of the unstable manifold with the line \$p\_\-x=a\$ as we grow the manifold from the fixed point.

We consider the unstable fundamental segment between the two points \$p+h\_\-u v\_\-u\$ and \$P(p+h\_\-u v\_\-u)\$. We iterate the unstable fundamental domain until it intersects the \$x\$ axis.

We discretize the unst domain into a set of NPOINTS segments u\_\-1, u\_\-2, ..., u\_\-NPOINTS. The image under iteration of this discretized version of the unst manifold is a set of segments U\_\-1, U\_\-2, ..., U\_\-NPOINTS that approximates the nonlinear unst manifold. We look for the first unst segment U\_\-i that intersects the \$x\$ axis. Therefore, U\_\-i contains an intersection point, and the segment u\_\-i in the fundamental domains contain the preimage of an intersection point.

This function returns the unstable segment u\_\-i with endpoints \$(h\_\-1, h\_\-2)\$ containing the approximate root \$p\_\-u=p + h\_\-u v\_\-u\$ with \$h\_\-u  (h\_\-1,h\_\-2)\$.

\begin{DoxyRemark}{Remarks}
If the first intersection point that we find is not part of the (continuous) family of primary intersections, then we keep looking for the primary one.
\end{DoxyRemark}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mu} & mass parameter for the RTBP \\
\hline
\mbox{\tt in}  & {\em H} & energy value \\
\hline
\mbox{\tt in}  & {\em k} & number of iterates of the Poincare map \\
\hline
\mbox{\tt in}  & {\em p} & fixed point \$p=(x,p\_\-x)\$ \\
\hline
\mbox{\tt in}  & {\em v} & eigenvector associated to unstable direction \\
\hline
\mbox{\tt in}  & {\em lambda} & eigenvalue associated to unstable direction\\
\hline
\mbox{\tt in}  & {\em h} & Small linear displacement along the manifold. This is typically obtained in function \hyperlink{errmfld_8c_ab913a873449a95304903ca2b824fd1d7}{h\_\-opt}.\\
\hline
\mbox{\tt in}  & {\em a} & line \$p\_\-x=a\$ parallel to the \$x\$ axis.\\
\hline
\mbox{\tt out}  & {\em piter} & On exit, it contains the number of iterations of the poincare map $\mathcal{P}$ needed to take the unstable segment u\_\-i to U\_\-i and straddle the \$x\$ axis.\\
\hline
\mbox{\tt out}  & {\em h\_\-1,h\_\-2} & On exit, it contains the endpoints of the unstable segment u\_\-i bracketing the approximate root \$p\_\-u=p + h\_\-u v\_\-u\$ with \$h\_\-u  (h\_\-1,h\_\-2)\$.\\
\hline
\mbox{\tt in,out}  & {\em z} & On entry, it contains the previous intersection point (for the previous energy level). On exit, it contains the approximate intersection point for this energy level.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a non-\/zero error code to indicate an error and 0 to indicate success.
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em 1} & Problems computing the Poincare iterates. \\
\hline
{\em 2} & No intersection found with the \$x\$ axis. \\
\hline
\end{DoxyRetVals}
